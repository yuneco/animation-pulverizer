const _=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};_();const I=(t,e)=>{const n=[],o=[];let r=document.elementFromPoint(t,e);for(;r&&!(r.tagName.toLowerCase()==="html"||!(r instanceof HTMLElement||r instanceof SVGElement));)o.push(r),n.push({el:r,pointerEvents:r.style.pointerEvents}),r.style.pointerEvents="none",r=document.elementFromPoint(t,e);return n.forEach(i=>i.el.style.pointerEvents=i.pointerEvents),o},u="animation-pulverizer_animatedClickTarget",L="animation-pulverizer_animatedClickHit",E="animation-pulverizer_ignored",N="animation-pulverizer_scoreLabel",h="animation-pulverizer_noiseFilter",O=t=>{const e=10,n=t.getBoundingClientRect(),o=n.width*n.height/(window.innerWidth*window.innerHeight);return Math.max(1,Math.round(1/o*e))},x=(t,e)=>{const n=document.createElement("div");n.textContent=`+${e}pt`,n.classList.add(E,N);const o=t.getBoundingClientRect();n.style.left=`${o.x}px`,n.style.top=`${o.y-80}px`,n.style.width=`${o.width}px`,document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n)},2e3)},R=(t,e=100)=>{t.animate([{opacity:t.style.opacity,transform:"scale(0.8)",filter:`blur(0) url('#${h}')`},{opacity:0,transform:"scale(1.5)",filter:`blur(10px) url('#${h}')`}],{fill:"forwards",duration:500}),x(t,e)},a=t=>t instanceof HTMLElement||t instanceof SVGElement,g=t=>t.classList.contains(L)?"hit":t.classList.contains(u)?"target":"wait",d=(t,e)=>{const n=g(t);if(n!==e){if(e==="hit"){if(n!=="target")return;P(t)}if(e==="target"){if(n!=="wait")return;k(t)}if(e==="wait"){if(n!=="target")return;D(t)}}},P=t=>{t.classList.remove(u),t.classList.add(L),R(t,O(t))},k=t=>{t.classList.add(u),t.removeEventListener("click",m),t.addEventListener("click",m)},D=t=>{t.classList.remove(u),t.removeEventListener("click",m)},m=t=>{console.log("direct",t),!!a(t.target)&&(d(t.target,"hit"),t.preventDefault(),t.stopImmediatePropagation(),t.target.removeEventListener("click",m))},F=["width","height","left","top","right","bottom","transform"],b=t=>!!(!a(t.target)||t.target.classList.contains(E)||t instanceof TransitionEvent&&F.includes(t.propertyName)),l=[],v=t=>{if(!!a(t.target))return{element:{el:t.target,pseudo:t.pseudoElement},prop:t instanceof TransitionEvent?t.propertyName:t.animationName,type:t instanceof TransitionEvent?"transition":"animation"}},$=(t,e)=>t.element.el===e.element.el&&t.element.pseudo===e.element.pseudo&&t.prop===e.prop&&t.type===e.type,q=t=>{const e=o=>{if(!a(o.target)||b(o)||g(o.target)!=="wait")return;const r=v(o);!r||(l.push(r),t([r.element],[],l.map(i=>i.element)))},n=o=>{if(o instanceof TransitionEvent&&b(o))return;const r=v(o);if(!r)return;const i=l.findIndex(p=>$(p,r));if(i===-1)return;const s=l.splice(i,1)[0];!s||t([],[s.element],l.map(p=>p.element))};document.body.addEventListener("transitionstart",e),document.body.addEventListener("transitionend",n),document.body.addEventListener("animationstart",e),document.body.addEventListener("animationend",n)},H=(t,e)=>({added:e.filter(n=>!t.includes(n)),removed:t.filter(n=>!e.includes(n))}),A=["width","height","left","top","right","bottom","transform"];let c=[];const G=100,z=t=>{const e=A.map(n=>{var o;return[n,(o=t.style[n])==null?void 0:o.toString()]}).filter(n=>n[1]);if(!!e.length)return Object.fromEntries(e)},B=(t,e)=>A.some(n=>t[n]!==e[n]),V=(t,e)=>{const n=z(t);if(!!n&&!(e&&!B(n,e.props)))return{el:t,isActive:!!e,expired:Date.now()+G,props:n}},U=t=>c.find(e=>e.el===t),W=t=>{const e=c.findIndex(n=>n.el===t);if(e!==-1)return c.splice(e,1)[0]},X=t=>{if(t.classList.contains(E))return;const e=U(t),n=V(t,e);!n||(W(t),g(t)!=="hit"&&n&&c.push(n))},j=()=>{const t=Date.now();c=c.filter(e=>e.expired>t)},K=()=>{new MutationObserver(function(e){e.map(o=>o.target).filter(a).forEach(X)}).observe(document.body,{subtree:!0,attributes:!0,attributeFilter:["style"]})},Y=()=>c.filter(t=>t.isActive).map(t=>t.el),J=t=>{let e=[];K();const n=()=>{j();const o=Y(),{added:r,removed:i}=H(e,o);if(r.length||i.length){try{t(r,i,o)}catch(s){console.warn(s)}e=[...o]}requestAnimationFrame(n)};n()};let y=[],S=[];const Q=t=>{q((e,n,o)=>{y=[...o],t(e,n,[...y,...S])}),J((e,n,o)=>{S=[...o.map(r=>({el:r,pseudo:""}))],t(e.map(r=>({el:r,pseudo:""})),n.map(r=>({el:r,pseudo:""})),[...y,...S])})};const Z=t=>`
<filter id='${t}' x='0%' y='0%' width='110%' height='110%'>
  <feTurbulence type="turbulence" baseFrequency="0.2 0.2" result="NOISE" numOctaves="2" />
  <feDisplacementMap in="SourceGraphic" in2="NOISE" scale="16" xChannelSelector="R" yChannelSelector="R"></feDisplacementMap>
</filter>
`,tt=()=>{const t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg");e.innerHTML=Z(h),document.body.appendChild(e)};let w=!1;const et=()=>{if(w)return;w=!0,console.log("\u{1F52B}GAME START!"),tt();let t=[];Q((e,n,o)=>{t=[...o],e.map(r=>{d(r.el,"target")}),n.map(r=>{d(r.el,"wait")})}),document.body.addEventListener("pointerdown",e=>{const n=I(e.clientX,e.clientY),o=t.map(i=>i.el),r=n.filter(i=>o.includes(i));r.forEach(i=>d(i,"hit")),r.length&&(e.preventDefault(),e.cancelBubble=!0)})},C=t=>t!=null;const nt=10,rt=".template .card",T="#app > .stage",ot="https://picsum.photos/seed/{seed}/300/200",it=4,st=["slide-toR","slide-toL","slide-toT","pop"],ct=t=>t[Math.floor(Math.random()*t.length)],f=(t,e)=>t+Math.floor(Math.random()*(e-t)),M=(t,e=1,n)=>{const o=Math.floor(e);if(o<1)return[];const r=n!=null?n:t.parentElement;return r?Array(o).fill(null).map(i=>r.appendChild(t.cloneNode(!0))):[]},at=()=>{const t=document.querySelector(T),e=document.querySelector(rt);if(!t||!e)return;const n=M(e,nt,t),o=n.map(i=>i.querySelector(".img")).filter(C),r=n.map(i=>i.querySelector(".text")).filter(C);[...o,...r].forEach(i=>M(i,f(0,it))),t.querySelectorAll(".img").forEach(i=>i.setAttribute("src",ot.replace("{seed}",f(1,1e4).toString())))},lt=()=>{const t=new IntersectionObserver(o=>{o.forEach(r=>{if(!r.isIntersecting)return;const i=r.target;!a(i)||i.classList.contains("show")||setTimeout(()=>{i.style.animationDuration=`${f(300,1200)}ms`,i.classList.add("show",ct(st))},f(0,500))})},{rootMargin:"0px 0px -15%"}),e=document.querySelector(T);if(!e)return;e.querySelectorAll(".target").forEach(o=>t.observe(o))},ut=()=>{at(),lt()};ut();et();
